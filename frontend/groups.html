<!-- frontend\groups.html -->
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Split App - Groups</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
  <link href="css/groups.css" rel="stylesheet">

</head>

<body>

  <!-- âœ… Navbar -->
  <div id="navbar" class="d-none d-md-block"></div>
  <!-- âœ… Mobile Navbar -->
  <div id="navbarMobile" class="d-md-none"></div>




  <!-- Desktop Groups Table -->
  <div class="container mt-5 d-none d-md-block">
    <!-- Header Section -->
    <div class="row mb-4">
      <div class="col-12">
        <div class="d-flex justify-content-between align-items-center mb-4">
          <h2 class="mb-0">
            <i class="bi bi-people-fill me-2 text-primary"></i>My Groups
          </h2>
          <div class="btn-group" role="group">
            <a class="btn btn-primary" href="dashboard.html">
              <i class="bi bi-receipt me-1"></i>All my Expense
            </a>
            <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#createGroupModal">
              <i class="bi bi-plus-circle me-1"></i>Create Group
            </button>
            <button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#addExpenseModal">
              <i class="bi bi-receipt me-1"></i>Add Expense
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Summary Statistics -->
    <div class="row mb-4" id="summaryStats">
      <div class="col-md-3">
        <div class="summary-card card h-100">
          <div class="card-body text-center">
            <i class="bi bi-people fs-1 text-primary mb-2"></i>
            <h5 class="card-title">Total Groups</h5>
            <h3 class="mb-0 text-primary" id="totalGroups">0</h3>
          </div>
        </div>
      </div>
      <div class="col-md-3">
        <div class="summary-card card h-100">
          <div class="card-body text-center">
            <i class="bi bi-heart fs-1 text-success mb-2"></i>
            <h5 class="card-title">Total Friends</h5>
            <h3 class="mb-0 text-success" id="totalFriends">0</h3>
          </div>
        </div>
      </div>
      <div class="col-md-3">
        <div class="summary-card card h-100">
          <div class="card-body text-center">
            <i class="bi bi-cash-stack fs-1 text-warning mb-2"></i>
            <h5 class="card-title">Total Expenses</h5>
            <h3 class="mb-0 text-warning" id="totalExpenses">0</h3>
          </div>
        </div>
      </div>
      <div class="col-md-3">
        <div class="summary-card card h-100">
          <div class="card-body text-center">
            <i class="bi bi-exclamation-triangle fs-1 text-warning mb-2"></i>
            <h5 class="card-title">Unsettled Groups</h5>
            <h3 class="mb-0 text-warning" id="unsettledGroups">0</h3>
          </div>
        </div>
      </div>
    </div>

    <!-- Search and Filter -->
    <div class="row mb-4">
      <div class="col-md-6">
        <div class="search-container">
          <i class="bi bi-search search-icon"></i>
          <input type="text" class="form-control" id="groupSearch" placeholder="Search groups...">
        </div>
      </div>
      <div class="col-md-6">
        <select class="form-select" id="groupFilter">
          <option value="">All Groups</option>
          <option value="Home">Home</option>
          <option value="Couple">Couple</option>
          <option value="Trip">Trip</option>
          <option value="Other">Other</option>
        </select>
      </div>
    </div>

    <!-- Groups Table -->
    <div class="table-enhanced">
      <table class="table table-hover align-middle text-center mb-0">
        <thead>
          <tr>

            <th><i class="bi bi-tag me-1"></i>Name</th>
            <th><i class="bi bi-currency-exchange me-1"></i>Currency</th>
            <th><i class="bi bi-person-crown me-1"></i>Owner</th>
            <th><i class="bi bi-people me-1"></i>Members</th>
            <th><i class="bi bi-calendar me-1"></i>Created</th>
            <th><i class="bi bi-gear me-1"></i>Actions</th>
          </tr>
        </thead>
        <tbody id="groupsTable">
          <tr>
            <td colspan="6" class="text-center text-muted py-4">
              <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Loading...</span>
              </div>
              <div class="mt-2">Loading groups...</div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- Mobile Groups -->
  <div class="d-md-none mt-4">
    <div class="container">
      <!-- Mobile Header -->
      <div class="row mb-3">
        <div class="col-12">
          <div class="d-flex justify-content-between align-items-center">
            <h4 class="mb-0">
              <i class="bi bi-people-fill me-2 text-primary"></i>Groups
            </h4>
            <button class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#createGroupModal">
              <i class="bi bi-plus-circle me-1"></i>Create
            </button>
          </div>
        </div>
      </div>

      <!-- Mobile Summary Cards -->
      <div class="row mb-3" id="mobileSummaryStats">
        <div class="col-6">
          <div class="summary-card card h-100">
            <div class="card-body text-center p-2">
              <i class="bi bi-people fs-4 text-primary mb-1"></i>
              <h6 class="mb-0 text-primary" id="mobileTotalGroups">0</h6>
              <small class="text-muted">Groups</small>
            </div>
          </div>
        </div>
        <div class="col-6">
          <div class="summary-card card h-100">
            <div class="card-body text-center p-2">
              <i class="bi bi-heart fs-4 text-success mb-1"></i>
              <h6 class="mb-0 text-success" id="mobileTotalFriends">0</h6>
              <small class="text-muted">Friends</small>
            </div>
          </div>
        </div>
      </div>

      <!-- Mobile Search -->
      <div class="row mb-3">
        <div class="col-12">
          <div class="search-container">
            <i class="bi bi-search search-icon"></i>
            <input type="text" class="form-control" id="mobileGroupSearch" placeholder="Search groups...">
          </div>
        </div>
      </div>

      <!-- Mobile Groups Cards -->
      <div class="container my-3" id="groupsMobileCards">
        <div class="text-center text-muted py-4">
          <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Loading...</span>
          </div>
          <div class="mt-2">Loading groups...</div>
        </div>
      </div>

      <!-- Floating Action Button -->
      <button class="fab" data-bs-toggle="modal" data-bs-target="#addExpenseModal">
        <i class="bi bi-plus-lg"></i>
      </button>
    </div>
  </div>

  <!-- Modals -->
  <!-- Create Group Modal -->
  <div class="modal fade" id="createGroupModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header bg-primary text-white">
          <h5 class="modal-title">
            <i class="bi bi-plus-circle me-2"></i>Create New Group
          </h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body p-4">
          <form id="createGroupForm">
            <div class="row mb-3">
              <div class="col-md-8">
                <label for="groupTitle" class="form-label fw-semibold">
                  <i class="bi bi-tag me-1"></i>Group Name
                </label>
                <input type="text" class="form-control" id="groupTitle"
                  placeholder="e.g. Trip to Paris, House Expenses..." required>
              </div>
              <div class="col-md-4">
                <label for="groupType" class="form-label fw-semibold">
                  <i class="bi bi-grid me-1"></i>Category
                </label>
                <select class="form-select" id="groupType" required>
                  <option value="Home">ğŸ  Home</option>
                  <option value="Couple">ğŸ’• Couple</option>
                  <option value="Trip">âœˆï¸ Trip</option>
                  <option value="Work">ğŸ’¼ Work</option>
                  <option value="Other">ğŸ“ Other</option>
                </select>
              </div>
            </div>

            <div class="row mb-3">
              <div class="col-12">
                <div class="form-check form-switch">
                  <input class="form-check-input" type="checkbox" id="isPersonalGroup"
                    onchange="toggleFriendSelection()">
                  <label class="form-check-label fw-semibold" for="isPersonalGroup">
                    <i class="bi bi-person-lock me-1"></i>Personal Group (Solo)
                  </label>
                  <div class="form-text">A private group for your own expenses. No other members can be added.</div>
                </div>
              </div>
            </div>

            <div class="row mb-3">
              <div class="col-md-6">
                <label for="groupCurrency" class="form-label fw-semibold">
                  <i class="bi bi-currency-exchange me-1"></i>Currency
                </label>
                <select class="form-select" id="groupCurrency" required>
                  <option value="MAD">ğŸ‡²ğŸ‡¦ MAD (Moroccan Dirham)</option>
                  <option value="USD">ğŸ‡ºğŸ‡¸ USD (US Dollar)</option>
                  <option value="EUR">ğŸ‡ªğŸ‡º EUR (Euro)</option>
                  <option value="GBP">ğŸ‡¬ğŸ‡§ GBP (British Pound)</option>
                  <option value="CAD">ğŸ‡¨ğŸ‡¦ CAD (Canadian Dollar)</option>
                  <option value="AED">ğŸ‡¦ğŸ‡ª AED (UAE Dirham)</option>
                  <option value="SAR">ğŸ‡¸ğŸ‡¦ SAR (Saudi Riyal)</option>
                  <option value="EGP">ğŸ‡ªğŸ‡¬ EGP (Egyptian Pound)</option>
                  <option value="TND">ğŸ‡¹ğŸ‡³ TND (Tunisian Dinar)</option>
                  <option value="DZD">ğŸ‡©ğŸ‡¿ DZD (Algerian Dinar)</option>
                </select>
              </div>
              <div class="col-md-6">
                <label class="form-label fw-semibold">
                  <i class="bi bi-calendar me-1"></i>Created Date
                </label>
                <input type="date" class="form-control" id="groupCreatedDate" readonly>
              </div>
            </div>

            <!-- Members Selection -->
            <div class="row mb-3">
              <h6 class="text-primary mb-3">
                <i class="bi bi-people me-1"></i>Invite Friends
              </h6>
              <div class="card border-0 bg-light">
                <div class="card-body p-3">
                  <div class="d-flex justify-content-between align-items-center mb-3">
                    <span class="text-muted">Select friends to invite to this group</span>
                    <div class="btn-group btn-group-sm" role="group">
                      <button type="button" class="btn btn-outline-primary" onclick="selectAllFriends()">
                        <i class="bi bi-check-all me-1"></i>Select All
                      </button>
                      <button type="button" class="btn btn-outline-secondary" onclick="deselectAllFriends()">
                        <i class="bi bi-x-square me-1"></i>Clear All
                      </button>
                    </div>
                  </div>


                  <div id="friendsListtoCreateGroup" class="friends-grid">
                    <div class="text-center text-muted py-3">
                      <i class="bi bi-hourglass-split"></i> Loading friends...
                    </div>


                  </div>
                </div>
              </div>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">
            <i class="bi bi-x-circle me-1"></i>Cancel
          </button>
          <button type="button" class="btn btn-success" onclick="createGroup()">
            <i class="bi bi-plus-circle me-1"></i>Create Group
          </button>
        </div>
      </div>
    </div>
  </div>


  <!-- =========================
     EDIT GROUP MODAL
========================= -->
  <div class="modal fade" id="editGroupModal" tabindex="-1" aria-labelledby="editGroupModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content rounded-3 shadow-lg border-0">
        <div class="modal-header bg-gradient-warning text-dark">
          <h5 class="modal-title fw-bold" id="editGroupModalLabel">
            <i class="bi bi-pencil-square me-2"></i>Edit Group
          </h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>

        <form id="editGroupForm">
          <div class="modal-body p-4">
            <input type="hidden" id="editGroupId" />
            <input type="hidden" id="editGroupOriginalType" />

            <!-- Basic Information -->
            <div class="row mb-4">
              <div class="col-12">
                <h6 class="text-primary mb-3">
                  <i class="bi bi-info-circle me-1"></i>Basic Information
                </h6>
              </div>
            </div>

            <div class="row">
              <div class="col-md-8">
                <div class="mb-3">
                  <label for="editGroupTitle" class="form-label fw-semibold">
                    <i class="bi bi-tag me-1"></i>Group Name
                  </label>
                  <input type="text" class="form-control form-control-lg" id="editGroupTitle"
                    placeholder="e.g. Trip to Paris, House Expenses..." required>
                  <div class="form-text">Choose a descriptive name for your group</div>
                </div>
              </div>
              <div class="col-md-4" id="editGroupCategoryDiv">
                <div class="mb-3">
                  <label for="editGroupCategory" class="form-label fw-semibold">
                    <i class="bi bi-grid me-1"></i>Category
                  </label>
                  <select class="form-select form-select-lg" id="editGroupCategory" required>
                    <option value="Home">ğŸ  Home</option>
                    <option value="Couple">ğŸ’• Couple</option>
                    <option value="Trip">âœˆï¸ Trip</option>
                    <option value="Work">ğŸ’¼ Work</option>
                    <option value="Other">ğŸ“ Other</option>
                  </select>
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col-md-6">
                <div class="mb-3">
                  <label for="editGroupCurrency" class="form-label fw-semibold">
                    <i class="bi bi-currency-exchange me-1"></i>Currency
                  </label>
                  <select class="form-select form-select-lg" id="editGroupCurrency" required>
                    <option value="">-- Select Currency --</option>
                    <option value="AED">ğŸ‡¦ğŸ‡ª AED â€” United Arab Emirates (Dirham)</option>
                    <option value="AFN">ğŸ‡¦ğŸ‡« AFN â€” Afghanistan (Afghani)</option>
                    <option value="ALL">ğŸ‡¦ğŸ‡± ALL â€” Albania (Lek)</option>
                    <option value="AMD">ğŸ‡¦ğŸ‡² AMD â€” Armenia (Dram)</option>
                    <option value="ANG">ğŸ‡³ğŸ‡± ANG â€” Netherlands Antilles (Guilder)</option>
                    <option value="AOA">ğŸ‡¦ğŸ‡´ AOA â€” Angola (Kwanza)</option>
                    <option value="ARS">ğŸ‡¦ğŸ‡· ARS â€” Argentina (Peso)</option>
                    <option value="AUD">ğŸ‡¦ğŸ‡º AUD â€” Australia (Dollar)</option>
                    <option value="AWG">ğŸ‡¦ğŸ‡¼ AWG â€” Aruba (Guilder)</option>
                    <option value="AZN">ğŸ‡¦ğŸ‡¿ AZN â€” Azerbaijan (Manat)</option>
                    <option value="BAM">ğŸ‡§ğŸ‡¦ BAM â€” Bosnia and Herzegovina (Marka)</option>
                    <option value="BBD">ğŸ‡§ğŸ‡§ BBD â€” Barbados (Dollar)</option>
                    <option value="BDT">ğŸ‡§ğŸ‡© BDT â€” Bangladesh (Taka)</option>
                    <option value="BGN">ğŸ‡§ğŸ‡¬ BGN â€” Bulgaria (Lev)</option>
                    <option value="BHD">ğŸ‡§ğŸ‡­ BHD â€” Bahrain (Dinar)</option>
                    <option value="BIF">ğŸ‡§ğŸ‡® BIF â€” Burundi (Franc)</option>
                    <option value="BMD">ğŸ‡§ğŸ‡² BMD â€” Bermuda (Dollar)</option>
                    <option value="BND">ğŸ‡§ğŸ‡³ BND â€” Brunei (Dollar)</option>
                    <option value="BOB">ğŸ‡§ğŸ‡´ BOB â€” Bolivia (Boliviano)</option>
                    <option value="BRL">ğŸ‡§ğŸ‡· BRL â€” Brazil (Real)</option>
                    <option value="BSD">ğŸ‡§ğŸ‡¸ BSD â€” Bahamas (Dollar)</option>
                    <option value="BTN">ğŸ‡§ğŸ‡¹ BTN â€” Bhutan (Ngultrum)</option>
                    <option value="BWP">ğŸ‡§ğŸ‡¼ BWP â€” Botswana (Pula)</option>
                    <option value="BYN">ğŸ‡§ğŸ‡¾ BYN â€” Belarus (Ruble)</option>
                    <option value="BZD">ğŸ‡§ğŸ‡¿ BZD â€” Belize (Dollar)</option>
                    <option value="CAD">ğŸ‡¨ğŸ‡¦ CAD â€” Canada (Dollar)</option>
                    <option value="CHF">ğŸ‡¨ğŸ‡­ CHF â€” Switzerland (Franc)</option>
                    <option value="CLP">ğŸ‡¨ğŸ‡± CLP â€” Chile (Peso)</option>
                    <option value="CNY">ğŸ‡¨ğŸ‡³ CNY â€” China (Yuan Renminbi)</option>
                    <option value="COP">ğŸ‡¨ğŸ‡´ COP â€” Colombia (Peso)</option>
                    <option value="CRC">ğŸ‡¨ğŸ‡· CRC â€” Costa Rica (ColÃ³n)</option>
                    <option value="CUP">ğŸ‡¨ğŸ‡º CUP â€” Cuba (Peso)</option>
                    <option value="CZK">ğŸ‡¨ğŸ‡¿ CZK â€” Czech Republic (Koruna)</option>
                    <option value="DJF">ğŸ‡©ğŸ‡¯ DJF â€” Djibouti (Franc)</option>
                    <option value="DKK">ğŸ‡©ğŸ‡° DKK â€” Denmark (Krone)</option>
                    <option value="DOP">ğŸ‡©ğŸ‡´ DOP â€” Dominican Republic (Peso)</option>
                    <option value="DZD">ğŸ‡©ğŸ‡¿ DZD â€” Algeria (Dinar)</option>
                    <option value="EGP">ğŸ‡ªğŸ‡¬ EGP â€” Egypt (Pound)</option>
                    <option value="EUR">ğŸ‡ªğŸ‡º EUR â€” European Union (Euro)</option>
                    <option value="FJD">ğŸ‡«ğŸ‡¯ FJD â€” Fiji (Dollar)</option>
                    <option value="GBP">ğŸ‡¬ğŸ‡§ GBP â€” United Kingdom (Pound Sterling)</option>
                    <option value="GHS">ğŸ‡¬ğŸ‡­ GHS â€” Ghana (Cedi)</option>
                    <option value="GIP">ğŸ‡¬ğŸ‡® GIP â€” Gibraltar (Pound)</option>
                    <option value="GMD">ğŸ‡¬ğŸ‡² GMD â€” Gambia (Dalasi)</option>
                    <option value="GNF">ğŸ‡¬ğŸ‡³ GNF â€” Guinea (Franc)</option>
                    <option value="GTQ">ğŸ‡¬ğŸ‡¹ GTQ â€” Guatemala (Quetzal)</option>
                    <option value="HKD">ğŸ‡­ğŸ‡° HKD â€” Hong Kong (Dollar)</option>
                    <option value="HNL">ğŸ‡­ğŸ‡³ HNL â€” Honduras (Lempira)</option>
                    <option value="HRK">ğŸ‡­ğŸ‡· HRK â€” Croatia (Kuna)</option>
                    <option value="HTG">ğŸ‡­ğŸ‡¹ HTG â€” Haiti (Gourde)</option>
                    <option value="HUF">ğŸ‡­ğŸ‡º HUF â€” Hungary (Forint)</option>
                    <option value="IDR">ğŸ‡®ğŸ‡© IDR â€” Indonesia (Rupiah)</option>
                    <option value="ILS">ğŸ‡®ğŸ‡± ILS â€” Israel (Shekel)</option>
                    <option value="INR">ğŸ‡®ğŸ‡³ INR â€” India (Rupee)</option>
                    <option value="IQD">ğŸ‡®ğŸ‡¶ IQD â€” Iraq (Dinar)</option>
                    <option value="IRR">ğŸ‡®ğŸ‡· IRR â€” Iran (Rial)</option>
                    <option value="ISK">ğŸ‡®ğŸ‡¸ ISK â€” Iceland (Krona)</option>
                    <option value="JMD">ğŸ‡¯ğŸ‡² JMD â€” Jamaica (Dollar)</option>
                    <option value="JOD">ğŸ‡¯ğŸ‡´ JOD â€” Jordan (Dinar)</option>
                    <option value="JPY">ğŸ‡¯ğŸ‡µ JPY â€” Japan (Yen)</option>
                    <option value="KES">ğŸ‡°ğŸ‡ª KES â€” Kenya (Shilling)</option>
                    <option value="KGS">ğŸ‡°ğŸ‡¬ KGS â€” Kyrgyzstan (Som)</option>
                    <option value="KHR">ğŸ‡°ğŸ‡­ KHR â€” Cambodia (Riel)</option>
                    <option value="KPW">ğŸ‡°ğŸ‡µ KPW â€” North Korea (Won)</option>
                    <option value="KRW">ğŸ‡°ğŸ‡· KRW â€” South Korea (Won)</option>
                    <option value="KWD">ğŸ‡°ğŸ‡¼ KWD â€” Kuwait (Dinar)</option>
                    <option value="KZT">ğŸ‡°ğŸ‡¿ KZT â€” Kazakhstan (Tenge)</option>
                    <option value="LAK">ğŸ‡±ğŸ‡¦ LAK â€” Laos (Kip)</option>
                    <option value="LBP">ğŸ‡±ğŸ‡§ LBP â€” Lebanon (Pound)</option>
                    <option value="LKR">ğŸ‡±ğŸ‡° LKR â€” Sri Lanka (Rupee)</option>
                    <option value="LYD">ğŸ‡±ğŸ‡¾ LYD â€” Libya (Dinar)</option>
                    <option value="MAD">ğŸ‡²ğŸ‡¦ MAD â€” Morocco (Dirham)</option>
                    <option value="MDL">ğŸ‡²ğŸ‡© MDL â€” Moldova (Leu)</option>
                    <option value="MGA">ğŸ‡²ğŸ‡¬ MGA â€” Madagascar (Ariary)</option>
                    <option value="MKD">ğŸ‡²ğŸ‡° MKD â€” North Macedonia (Denar)</option>
                    <option value="MMK">ğŸ‡²ğŸ‡² MMK â€” Myanmar (Kyat)</option>
                    <option value="MNT">ğŸ‡²ğŸ‡³ MNT â€” Mongolia (Tugrik)</option>
                    <option value="MOP">ğŸ‡²ğŸ‡´ MOP â€” Macau (Pataca)</option>
                    <option value="MRO">ğŸ‡²ğŸ‡· MRO â€” Mauritania (Ouguiya)</option>
                    <option value="MUR">ğŸ‡²ğŸ‡º MUR â€” Mauritius (Rupee)</option>
                    <option value="MWK">ğŸ‡²ğŸ‡¼ MWK â€” Malawi (Kwacha)</option>
                    <option value="MXN">ğŸ‡²ğŸ‡½ MXN â€” Mexico (Peso)</option>
                    <option value="MYR">ğŸ‡²ğŸ‡¾ MYR â€” Malaysia (Ringgit)</option>
                    <option value="MZN">ğŸ‡²ğŸ‡¿ MZN â€” Mozambique (Metical)</option>
                    <option value="NAD">ğŸ‡³ğŸ‡¦ NAD â€” Namibia (Dollar)</option>
                    <option value="NGN">ğŸ‡³ğŸ‡¬ NGN â€” Nigeria (Naira)</option>
                    <option value="NOK">ğŸ‡³ğŸ‡´ NOK â€” Norway (Krone)</option>
                    <option value="NPR">ğŸ‡³ğŸ‡µ NPR â€” Nepal (Rupee)</option>
                    <option value="NZD">ğŸ‡³ğŸ‡¿ NZD â€” New Zealand (Dollar)</option>
                    <option value="OMR">ğŸ‡´ğŸ‡² OMR â€” Oman (Rial)</option>
                    <option value="PEN">ğŸ‡µğŸ‡ª PEN â€” Peru (Sol)</option>
                    <option value="PHP">ğŸ‡µğŸ‡­ PHP â€” Philippines (Peso)</option>
                    <option value="PKR">ğŸ‡µğŸ‡° PKR â€” Pakistan (Rupee)</option>
                    <option value="PLN">ğŸ‡µğŸ‡± PLN â€” Poland (ZÅ‚oty)</option>
                    <option value="QAR">ğŸ‡¶ğŸ‡¦ QAR â€” Qatar (Riyal)</option>
                    <option value="RON">ğŸ‡·ğŸ‡´ RON â€” Romania (Leu)</option>
                    <option value="RSD">ğŸ‡·ğŸ‡¸ RSD â€” Serbia (Dinar)</option>
                    <option value="RUB">ğŸ‡·ğŸ‡º RUB â€” Russia (Ruble)</option>
                    <option value="SAR">ğŸ‡¸ğŸ‡¦ SAR â€” Saudi Arabia (Riyal)</option>
                    <option value="SDG">ğŸ‡¸ğŸ‡© SDG â€” Sudan (Pound)</option>
                    <option value="SEK">ğŸ‡¸ğŸ‡ª SEK â€” Sweden (Krona)</option>
                    <option value="SGD">ğŸ‡¸ğŸ‡¬ SGD â€” Singapore (Dollar)</option>
                    <option value="SYP">ğŸ‡¸ğŸ‡¾ SYP â€” Syria (Pound)</option>
                    <option value="THB">ğŸ‡¹ğŸ‡­ THB â€” Thailand (Baht)</option>
                    <option value="TND">ğŸ‡¹ğŸ‡³ TND â€” Tunisia (Dinar)</option>
                    <option value="TRY">ğŸ‡¹ğŸ‡· TRY â€” TÃ¼rkiye (Lira)</option>
                    <option value="TWD">ğŸ‡¹ğŸ‡¼ TWD â€” Taiwan (Dollar)</option>
                    <option value="TZS">ğŸ‡¹ğŸ‡¿ TZS â€” Tanzania (Shilling)</option>
                    <option value="UAH">ğŸ‡ºğŸ‡¦ UAH â€” Ukraine (Hryvnia)</option>
                    <option value="UGX">ğŸ‡ºğŸ‡¬ UGX â€” Uganda (Shilling)</option>
                    <option value="USD">ğŸ‡ºğŸ‡¸ USD â€” United States (Dollar)</option>
                    <option value="UYU">ğŸ‡ºğŸ‡¾ UYU â€” Uruguay (Peso)</option>
                    <option value="UZS">ğŸ‡ºğŸ‡¿ UZS â€” Uzbekistan (Som)</option>
                    <option value="VEF">ğŸ‡»ğŸ‡ª VEF â€” Venezuela (BolÃ­var)</option>
                    <option value="VND">ğŸ‡»ğŸ‡³ VND â€” Vietnam (Dong)</option>
                    <option value="XAF">ğŸŒ XAF â€” Central Africa (CFA Franc)</option>
                    <option value="XOF">ğŸŒ XOF â€” West Africa (CFA Franc)</option>
                    <option value="YER">ğŸ‡¾ğŸ‡ª YER â€” Yemen (Rial)</option>
                    <option value="ZAR">ğŸ‡¿ğŸ‡¦ ZAR â€” South Africa (Rand)</option>
                    <option value="ZMW">ğŸ‡¿ğŸ‡² ZMW â€” Zambia (Kwacha)</option>
                  </select>
                </div>
              </div>
              <div class="col-md-6">
                <div class="mb-3">
                  <label for="editGroupPhoto" class="form-label fw-semibold">
                    <i class="bi bi-image me-1"></i>Group Photo URL
                  </label>
                  <input type="url" class="form-control form-control-lg" id="editGroupPhoto"
                    placeholder="https://example.com/photo.jpg">
                  <div class="form-text">Optional: Add a photo URL for your group</div>
                </div>
              </div>
            </div>

            <!-- Description -->
            <div class="mb-4">
              <h6 class="text-primary mb-3">
                <i class="bi bi-chat-text me-1"></i>Description
              </h6>
              <div class="mb-3">
                <label for="editGroupDescription" class="form-label fw-semibold">
                  <i class="bi bi-card-text me-1"></i>Group Description
                </label>
                <textarea class="form-control form-control-lg" id="editGroupDescription" rows="3"
                  placeholder="Describe your group..."></textarea>
                <div class="form-text">Tell others what this group is about</div>
              </div>
            </div>
          </div>

          <div class="modal-footer bg-light">
            <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">
              <i class="bi bi-x-circle me-1"></i>Cancel
            </button>
            <button type="submit" class="btn btn-primary fw-bold">
              <i class="bi bi-check-circle me-1"></i>Save Changes
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!--  Unified Add Expense Modal -->
  <div class="modal fade" id="addExpenseModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-xl modal-dialog-scrollable">
      <div class="modal-content shadow-lg border-0">
        <div class="modal-header bg-success text-white">
          <h5 class="modal-title">
            <i class="bi bi-receipt me-2"></i>Add New Expense
          </h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body p-3 p-md-4">
          <form id="addExpenseForm">
            <!-- Step 1: Basic Info -->
            <div class="row mb-3">
              <div class="col-12">
                <h6 class="text-success mb-2 mb-md-3">
                  <i class="bi bi-info-circle me-1"></i>Expense Details
                </h6>
              </div>
            </div>

            <div class="row mb-3">
              <div class="col-md-6 mb-3 mb-md-0">
                <label class="form-label fw-semibold">
                  <i class="bi bi-calendar me-1"></i>Date
                </label>
                <input type="date" class="form-control" id="expenseDate" required>
              </div>
              <div class="col-md-6">
                <label class="form-label fw-semibold">
                  <i class="bi bi-clock me-1"></i>Time
                </label>
                <input type="time" class="form-control" id="expenseTime" required>
              </div>
            </div>

            <div class="row mb-3">
              <div class="col-md-8 mb-3 mb-md-0">
                <label class="form-label fw-semibold">
                  <i class="bi bi-tag me-1"></i>Description
                </label>
                <input type="text" class="form-control" id="expenseDesc" placeholder="What was this expense for?"
                  required>
                <div class="form-text">Be specific about what you're splitting</div>
              </div>
              <div class="col-md-4">
                <label class="form-label fw-semibold">
                  <i class="bi bi-grid me-1"></i>Category
                </label>
                <select class="form-select" id="expenseCategory">
                  <option value="Food">ğŸ½ï¸ Food & Dining</option>
                  <option value="Transport">ğŸš— Transportation</option>
                  <option value="Shopping">ğŸ›ï¸ Shopping</option>
                  <option value="Entertainment">ğŸ¬ Entertainment</option>
                  <option value="Travel">âœˆï¸ Travel</option>
                  <option value="Utilities">âš¡ Utilities</option>
                  <option value="Billing">ğŸ’³ Billing</option>
                  <option value="Other">ğŸ“ Other</option>
                </select>
              </div>
            </div>

            <!-- Note -->
            <div class="row mb-3">
              <label class="form-label fw-semibold">Note</label>
              <textarea type="text" class="form-control" id="expenseNote" rows="2"
                placeholder="Add a note (optional)"></textarea>
              <div class="form-text">Add an note </div>
            </div>

            <!-- Step 2: Amount & Payment -->
            <div class="row mb-3">
              <div class="col-12">
                <h6 class="text-success mb-2 mb-md-3">
                  <i class="bi bi-cash-stack me-1"></i>Amount & Payment
                </h6>
              </div>
            </div>

            <div class="row mb-3">
              <div class="col-md-6 mb-3 mb-md-0">
                <label class="form-label fw-semibold">
                  <i class="bi bi-cash-stack me-1"></i>Amount
                </label>
                <div class="input-group">
                  <input type="number" step="0.01" class="form-control" id="expenseAmount" placeholder="0.00" min="0.01"
                    required>
                  <span class="input-group-text" id="currencyDisplay">MAD</span>
                </div>
                <div class="form-text">Total amount spent</div>
              </div>
              <div class="col-md-6">
                <label class="form-label fw-semibold">
                  <i class="bi bi-collection me-1"></i>Select Group
                </label>
                <select id="groupsListForExpenses" class="form-select" required>
                  <option value="">-- Choose a group --</option>
                </select>
                <div class="form-text">Which group is this expense for?</div>
              </div>
            </div>

            <!-- Step 3: Payer Selection -->
            <div class="row mb-3">
              <div class="col-12">
                <h6 class="text-primary mb-2 mb-md-3">
                  <i class="bi bi-person-check me-1"></i>Who Paid?
                </h6>
              </div>
            </div>
            <div class="row mb-3">
              <div class="col-12">
                <label class="form-label fw-semibold">
                  <i class="bi bi-person-fill me-1"></i>Payer <span class="text-danger">*</span>
                </label>
                <select class="form-select" id="expensePayer" required>
                  <option value="">Select who paid...</option>
                </select>
                <div class="form-text">Who actually paid for this expense?</div>
              </div>
            </div>

            <!-- Wallet section - only shows for current user -->
            <div class="row mb-3" id="walletSection" style="display: none;">
              <div class="col-12">
                <label class="form-label fw-semibold">
                  <i class="bi bi-wallet2 me-1"></i>Wallet <small class="text-muted">(Optional)</small>
                </label>
                <select class="form-select" id="expenseWallet">
                  <option value="">No wallet selected</option>
                </select>
                <div class="form-text">Deduct from your wallet balance</div>
              </div>
            </div>

            <!-- Step 4: Members Selection -->
            <div class="row mb-3">
              <div class="col-12">
                <h6 class="text-success mb-2 mb-md-3">
                  <i class="bi bi-people me-1"></i>Select Members
                </h6>
              </div>
            </div>

            <div class="card border-0 bg-light">
              <div class="card-body p-3">
                <div class="d-flex justify-content-between align-items-center mb-3">
                  <span class="text-muted small">Who should split this expense?</span>
                  <div class="btn-group btn-group-sm" role="group">
                    <button type="button" class="btn btn-outline-success" onclick="selectAllMembers()">
                      <i class="bi bi-check-all me-1"></i><span class="d-none d-sm-inline">Select All</span>
                    </button>
                    <button type="button" class="btn btn-outline-secondary" onclick="deselectAllMembers()">
                      <i class="bi bi-x-square me-1"></i><span class="d-none d-sm-inline">Clear All</span>
                    </button>
                  </div>
                </div>
                <div id="membersListForGroups" class="border rounded p-3 bg-white"
                  style="max-height: 200px; overflow-y: auto;">
                  <div class="text-center text-muted py-3">
                    <i class="bi bi-info-circle fs-1 mb-2"></i>
                    <p class="mb-0">Select a group first to see members</p>
                  </div>
                </div>
              </div>
            </div>

            <!-- Expense Preview -->
            <div class="card bg-success text-white mt-3" id="expensePreview" style="display: none;">
              <div class="card-body">
                <h6 class="card-title">
                  <i class="bi bi-eye me-1"></i>Expense Preview
                </h6>
                <div class="row">
                  <div class="col-6 col-md-3 mb-2">
                    <small>Total Amount:</small>
                    <div class="fw-bold" id="previewAmount">0.00 MAD</div>
                  </div>
                  <div class="col-6 col-md-3 mb-2">
                    <small>Per Person:</small>
                    <div class="fw-bold" id="previewPerPerson">0.00 MAD</div>
                  </div>
                  <div class="col-6 col-md-3 mb-2">
                    <small>Members:</small>
                    <div class="fw-bold" id="previewMemberCount">0</div>
                  </div>
                  <div class="col-6 col-md-3 mb-2">
                    <small>Category:</small>
                    <div class="fw-bold" id="previewCategory">-</div>
                  </div>
                </div>
              </div>
            </div>
          </form>
        </div>
        <div class="modal-footer bg-light">
          <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">
            <i class="bi bi-x-circle me-1"></i>Cancel
          </button>
          <button type="button" class="btn btn-success" onclick="addExpenseModalSubmit()">
            <i class="bi bi-check-circle me-1"></i>Add Expense
          </button>
        </div>
      </div>
    </div>
  </div>







  <!-- Scripts -->
  <script src="js/config.js"></script>
  <script src="js/notifications.js"></script>
  <script src="js/navbar.js"></script>
  <script src="js/group.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    if (!localStorage.getItem("token")) window.location.href = "login.html";


  </script>

</body>

</html>